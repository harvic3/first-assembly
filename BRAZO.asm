		LIST P=16F877A
		INCLUDE P16F877A.INC
		CBLOCK 20H
		PD0,PD1
		ENDC
;INICIO DEL PROGRAMA

		ORG 00
		GOTO CONF_PORT
		ORG	05
;***********************************************************************

RETARDO50m  movlw     .55       ; 1 set numero de repeticion  (B)
           	movwf     PD0     ; 1 |
PLoop1  	movlw     .181      ; 1 set numero de repeticion  (A)
        	movwf     PD1     ; 1 |
PLoop2  	clrwdt              ; 1 clear watchdog
        	clrwdt              ; 1 ciclo delay
        	decfsz    PD1, 1  ; 1 + (1) es el tiempo 0  ? (A)
        	goto      PLoop2    ; 2 no, loop
        	decfsz    PD0,  1 ; 1 + (1) es el tiempo 0  ? (B)
        	goto      PLoop1    ; 2 no, loop
        	return              ; 2+2 Fin.
;***********************************************************************

CONF_PORT BCF		STATUS,6		;CAMBIAMOS DE BANKO AL BANK 1 DONDE SE CONFIG LOS TRIS
		  BSF		STATUS,5		;	"		"			"
	  	  MOVLW		0x06		; CONFIGURAR LOS LOS PINES 
		  MOVWF		ADCON1	
		  CLRF		TRISB
		  CLRF		TRISA
		  CLRF		TRISD
		  MOVLW		B'11111111'
		  MOVWF		TRISC
		  CLRF		TRISE
		  CLRF		81
		  BCF		STATUS,5		;VOLVEMOS AL BANK 0
		  CLRF		INTCON
		  MOVLW		B'11111111'
		  MOVWF		PORTA
		  MOVWF		PORTB
		  MOVWF		PORTD
		  MOVWF		PORTE
		  GOTO   	INICIO	
;***********************************************************************
;INICIO DEL PROGRAMA

;'PORTA	RA0-RA3'
M1DER		;PASO 1
			MOVF	PORTA,W
			ANDLW	B'110000'
			ADDLW	B'000111'
			MOVWF	PORTA
			CALL	RETARDO50m
			;PASO 2
			MOVF	PORTA,W
			ANDLW	B'110000'
			ADDLW	B'001101'
			MOVWF	PORTA
			CALL	RETARDO50m
			;PASO 3
			MOVF	PORTA,W
			ANDLW	B'110000'
			ADDLW	B'001011'
			MOVWF	PORTA
			CALL	RETARDO50m
		    ;PASO 4
			MOVF	PORTA,W
			ANDLW	B'110000'
			ADDLW	B'001110'
			MOVWF	PORTA
			CALL	RETARDO50m
			GOTO	PROC0

M1IZQ		;PASO 4
			MOVF	PORTA,W
			ANDLW	B'110000'
			ADDLW	B'001110'
			MOVWF	PORTA
			CALL	RETARDO50m
			;PASO 3
			MOVF	PORTA,W
			ANDLW	B'110000'
			ADDLW	B'001011'
			MOVWF	PORTA
			CALL	RETARDO50m
			;PASO 2
			MOVF	PORTA,W
			ANDLW	B'110000'
			ADDLW	B'001101'
			MOVWF	PORTA
			CALL	RETARDO50m
			;PASO 1
			MOVF	PORTA,W
			ANDLW	B'110000'
			ADDLW	B'000111'
			MOVWF	PORTA
			CALL	RETARDO50m
			GOTO	PROC1
;*************************************************************************

;`PORTB	RB4-RB7'
M2DER		;PASO 1
			MOVF	PORTB,W
			ANDLW	B'00001111'
			ADDLW	B'00110000'
			MOVWF	PORTB
			CALL	RETARDO50m
			;PASO 2
			MOVF	PORTB,W
			ANDLW	B'00001111'
			ADDLW	B'10010000'
			MOVWF	PORTB
			CALL	RETARDO50m
			;PASO 3
			MOVF	PORTB,W
			ANDLW	B'00001111'
			ADDLW	B'11000000'
			MOVWF	PORTB
			CALL	RETARDO50m
		    ;PASO 4
			MOVF	PORTB,W
			ANDLW	B'00001111'
			ADDLW	B'01100000'
			MOVWF	PORTB
			CALL	RETARDO50m
			GOTO	PROC2

M2IZQ		;PASO 4
			MOVF	PORTB,W
			ANDLW	B'00001111'
			ADDLW	B'01100000'
			MOVWF	PORTB
			CALL	RETARDO50m
			;PASO 3
			MOVF	PORTB,W
			ANDLW	B'00001111'
			ADDLW	B'11000000'
			MOVWF	PORTB
			CALL	RETARDO50m
			;PASO 2
			MOVF	PORTB,W
			ANDLW	B'00001111'
			ADDLW	B'10010000'
			MOVWF	PORTB
			CALL	RETARDO50m
			;PASO 1
			MOVF	PORTB,W
			ANDLW	B'00001111'
			ADDLW	B'00110000'
			MOVWF	PORTB
			CALL	RETARDO50m
			GOTO	PROC3
;*********************************************************************

;`PORTB	RB0-RB3'
M3DER		;PASO 1
			MOVF	PORTB,W
			ANDLW	B'11110000'
			ADDLW	B'00000011'
			MOVWF	PORTB
			CALL	RETARDO50m
			;PASO 2
			MOVF	PORTB,W
			ANDLW	B'11110000'
			ADDLW	B'00001001'
			MOVWF	PORTB
			CALL	RETARDO50m
			;PASO 3
			MOVF	PORTB,W
			ANDLW	B'11110000'
			ADDLW	B'00001100'
			MOVWF	PORTB
			CALL	RETARDO50m
		    ;PASO 4
			MOVF	PORTB,W
			ANDLW	B'11110000'
			ADDLW	B'00000110'
			MOVWF	PORTB
			CALL	RETARDO50m
			GOTO	PROC4

M3IZQ		;PASO 4
			MOVF	PORTB,W
			ANDLW	B'11110000'
			ADDLW	B'00000110'
			MOVWF	PORTB
			CALL	RETARDO50m
			;PASO 3
			MOVF	PORTB,W
			ANDLW	B'11110000'
			ADDLW	B'00001100'
			MOVWF	PORTB
			CALL	RETARDO50m
			;PASO 2
			MOVF	PORTB,W
			ANDLW	B'11110000'
			ADDLW	B'00001001'
			MOVWF	PORTB
			CALL	RETARDO50m
			;PASO 1
			MOVF	PORTB,W
			ANDLW	B'11110000'
			ADDLW	B'00000011'
			MOVWF	PORTB
			CALL	RETARDO50m
			GOTO	PROC5

;**********************************************************************

;`PORTD	RD4-RD7'
M4DER		;PASO 1
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'00110000'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 2
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'10010000'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 3
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'11000000'
			MOVWF	PORTD
			CALL	RETARDO50m
		    ;PASO 4
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'01100000'
			MOVWF	PORTD
			CALL	RETARDO50m
			GOTO	PROC6
	
M4IZQ		;PASO 4
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'01100000'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 3
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'11000000'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 2
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'10010000'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 1
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'00110000'
			MOVWF	PORTD
			CALL	RETARDO50m
			GOTO	PROC7

;***********************************************************************

;`PORTD	RD0-RD3'
M5DER		;PASO 1
			MOVF	PORTD,W
			ANDLW	B'11110000'
			ADDLW	B'00000111'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 2
			MOVF	PORTD,W
			ANDLW	B'11110000'
			ADDLW	B'00001011'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 3
			MOVF	PORTD,W
			ANDLW	B'11110000'
			ADDLW	B'00001101'
			MOVWF	PORTD
			CALL	RETARDO50m
		    ;PASO 4
			MOVF	PORTD,W
			ANDLW	B'11110000'
			ADDLW	B'00001110'
			MOVWF	PORTD
			CALL	RETARDO50m
			GOTO	PROC8

M5IZQ		;PASO 4
			MOVF	PORTD,W
			ANDLW	B'11110000'
			ADDLW	B'00001110'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 3
			MOVF	PORTD,W
			ANDLW	B'11110000'
			ADDLW	B'00001101'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 2
			MOVF	PORTD,W
			ANDLW	B'11110000'
			ADDLW	B'00001011'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 1
			MOVF	PORTD,W
			ANDLW	B'11110000'
			ADDLW	B'00000111'
			MOVWF	PORTD
			CALL	RETARDO50m
			GOTO	PROC9

;*********************************************************************

;`PORTE	RE0-RE1'
M6DER		BSF		PORTE,1
			BCF		PORTE,0
			BSF		PORTE,1
REVIZAR		MOVF	PORTC,W
			XORLW	B'01000001'
			BTFSC	STATUS,Z
			GOTO	REVIZAR
			BSF		PORTE,0
			BSF		PORTE,1
			GOTO	PROC11

M6IZQ		BSF		PORTE,0
			BCF		PORTE,1
REVIZAR2	MOVF	PORTC,W
			XORLW	B'01000000'
			BTFSC	STATUS,Z
			GOTO	REVIZAR2
			BSF		PORTE,0
			BSF		PORTE,1
			GOTO	PROC12

;*********************************************************************

M234DER		;PASO 1
			MOVF	PORTB,W
			ANDLW	B'00000000'
			ADDLW	B'01100011'
			MOVWF	PORTB
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'00110000'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 2
			MOVF	PORTB,W
			ANDLW	B'00000000'
			ADDLW	B'11001001'
			MOVWF	PORTB
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'10010000'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 3
			MOVF	PORTB,W
			ANDLW	B'00000000'
			ADDLW	B'10011100'
			MOVWF	PORTB
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'11000000'
			MOVWF	PORTD
			CALL	RETARDO50m
		    ;PASO 4
			MOVF	PORTB,W
			ANDLW	B'00000000'
			ADDLW	B'00110110'
			MOVWF	PORTB
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'01100000'
			MOVWF	PORTD
			CALL	RETARDO50m
			GOTO	PROC12

M234IZQ		;PASO 4
			MOVF	PORTB,W
			ANDLW	B'00000000'
			ADDLW	B'00110110'
			MOVWF	PORTB
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'01100000'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 3
			MOVF	PORTB,W
			ANDLW	B'00000000'
			ADDLW	B'10011100'
			MOVWF	PORTB
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'11000000'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 2
			MOVF	PORTB,W
			ANDLW	B'00000000'
			ADDLW	B'11001001'
			MOVWF	PORTB
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'10010000'
			MOVWF	PORTD
			CALL	RETARDO50m
			;PASO 1
			MOVF	PORTB,W
			ANDLW	B'00000000'
			ADDLW	B'01100011'
			MOVWF	PORTB
			MOVF	PORTD,W
			ANDLW	B'00001111'
			ADDLW	B'00110000'
			MOVWF	PORTD
			CALL	RETARDO50m	

;*********************************************************************

INICIO	
PROC0		MOVLW	B'00111111'
		  	MOVWF	PORTA
			MOVF	PORTC,W
			XORLW  	B'00000011'
            BTFSS  	STATUS,Z
            GOTO 	PROC1
			CALL	M1DER
PROC1       MOVLW	B'00111111'
		  	MOVWF	PORTA
			MOVF	PORTC,W
			XORLW	B'00000010'
            BTFSS	STATUS,Z
            GOTO	PROC2
			GOTO	M1IZQ
PROC2		MOVF	PORTC,W
			XORLW	B'00000101'
			BTFSS	STATUS,Z
			GOTO	PROC3
			GOTO	M2DER
PROC3		MOVF	PORTC,W
			XORLW	B'00000100'
			BTFSS	STATUS,Z
            GOTO	PROC4
			GOTO	M2IZQ			
PROC4		MOVF	PORTC,W
			XORLW	B'00001001'
			BTFSS	STATUS,Z
            GOTO	PROC5
			GOTO	M3DER
PROC5		MOVF	PORTC,W
			XORLW	B'00001000'
			BTFSS	STATUS,Z
            GOTO	PROC6
			GOTO	M3IZQ
PROC6		MOVF	PORTC,W
			XORLW	B'00010001'
			BTFSS	STATUS,Z
            GOTO	PROC7
			GOTO	M4DER
PROC7		MOVF	PORTC,W
			XORLW	B'00010000'
			BTFSS	STATUS,Z
            GOTO	PROC8
			GOTO	M4IZQ
PROC8		MOVF	PORTC,W
		    XORLW	B'00100001'
			BTFSS	STATUS,Z
			GOTO	PROC9
			GOTO	M5DER
PROC9		MOVF	PORTC,W
			XORLW	B'00100000'
			BTFSS	STATUS,Z
            GOTO	PROC10
			GOTO	M5IZQ
PROC10		MOVF	PORTC,W
			XORLW	B'01000001'
			BTFSC	STATUS,Z
			GOTO	M6DER
PROC11		MOVF	PORTC,W
			XORLW	B'01000000'
			BTFSC	STATUS,Z
			GOTO	M6IZQ
			BSF		PORTA,4
			BSF		PORTA,5
PROCFREN	MOVF	PORTC,W
			XORLW	B'01100000'
			BTFSC	STATUS,Z
			BCF		PORTE,1
PROC12		MOVF	PORTC,W
			XORLW	B'10000001'
			BTFSS	STATUS,Z
            GOTO	PROC13
			CALL	M234DER
PROC13		MOVF	PORTC,W
			XORLW	B'10000000'
			BTFSC	STATUS,Z
			GOTO	M234IZQ
			GOTO	PROC0
			
	       	END